# plugins/ai_single.py
"""
๐ง ุฃูุฑ ุงูุฐูุงุก ุงูุงุตุทูุงุนู ุงููุงุญุฏ - ุณูุฑุณ ูููู
ุชู ุญุฐู ุฃูุฑ ุงูููุณููู ุจูุงุกู ุนูู ุทูุจ ุงููุทูุฑ ุญุณูู
"""

SECTION_NAME = "๐ง ุงูุฐูุงุก ุงูุงุตุทูุงุนู"
COMMANDS = "`.ุฐูุงุก` - ูุงุฆูุฉ ุฌููุน ุฃูุงูุฑ ุงูุฐูุงุก ุงูุงุตุทูุงุนู ุงููุฏูุฌุฉ"

from telethon import events
import aiohttp
import json
import random
# ุงุณุชูุฑุงุฏ ูุญุฑู Gemini ุงููุทูุฑ ูู ุณูุฑุณ ูููู

# =========================================================
# ๐ฏ ุฃูุฑ ุงูุฐูุงุก ุงููุทูุฑ (ูุณุฎุฉ ุญุณูู)
# =========================================================

@client.on(events.NewMessage(outgoing=True, pattern=r'\.ุฐูุงุก'))
async def ai_all_in_one(event):
    """ุฃูุฑ ูุงุญุฏ ูุญุชูู ุฌููุน ุฃูุงูุฑ ุงูุฐูุงุก ุจุฏูู ููุณููู"""
    
    # ุฅุฐุง ูุชุจ ููุท .ุฐูุงุก ุจุฏูู ูุต ูุนุฑุถ ุงููุงุฆูุฉ ุงูููุธูุฉ
    if " " not in event.text:
        ai_menu = """
๐ง **๐ ุณูุฑุณ ูููููู - ูุงุฆูุฉ ุงูุฐูุงุก ุงูุงุตุทูุงุนู ุงููุชูุงููุฉ ๐**

**๐ ููู ุชุณุชุฎุฏู ุงูุฃูุฑ:**
`.ุฐูุงุก ุณุคุงู [ุณุคุงูู]` โ ูุญุงุฏุซุฉ ุฐููุฉ
`.ุฐูุงุก ุตูุฑุฉ [ูุตู]` โ ุฅูุดุงุก ุตูุฑุฉ
`.ุฐูุงุก ููุฏ [ูุบุฉ] [ูุตู]` โ ูุชุงุจุฉ ููุฏ
`.ุฐูุงุก ููุงู [ููุถูุน]` โ ูุชุงุจุฉ ููุงู
`.ุฐูุงุก ุชุฑุฌู [ูุบุฉ] [ูุต]` โ ุชุฑุฌูุฉ
`.ุฐูุงุก ูุฎุต [ูุต]` โ ุชูุฎูุต
`.ุฐูุงุก ุญู [ูุดููุฉ]` โ ุญู ุงููุดุงูู
`.ุฐูุงุก ุงููุงุฑ [ููุถูุน]` โ ุฃููุงุฑ ุฅุจุฏุงุนูุฉ
`.ุฐูุงุก ุชุนูู [ููุถูุน]` โ ุดุฑุญ ุชุนูููู
`.ุฐูุงุก ูุตุฉ [ููุฑุฉ]` โ ูุชุงุจุฉ ูุตุฉ
`.ุฐูุงุก ุดุนุฑ [ููุถูุน]` โ ูุตูุฏุฉ ุดุนุฑูุฉ
`.ุฐูุงุก ุชุตููู [ูุตู]` โ ุชุตูููุงุช
`.ุฐูุงุก ุฎุทุท [ูุฏู]` โ ุชุฎุทูุท
`.ุฐูุงุก ุงุฎุชุจุฑ [ููุถูุน]` โ ุงุฎุชุจุงุฑ ูุนุฑูู
`.ุฐูุงุก ุญููุฉ` โ ุญููุฉ ุนุดูุงุฆูุฉ

**๐ค ุงููุทูุฑ:** @iomk0 | **๐ข ุงูููุงุฉ:** @iomk3
        """
        await event.edit(ai_menu)
        return
    
    # ุชุญููู ุงูุฃูุฑ ุงููุฏุฎู
    full_text = event.text.replace('.ุฐูุงุก ', '').strip()
    
    # ูุธุงู ุงูุฐูุงุก ุงูุงุตุทูุงุนู Gemini 2.0 Flash Lite
    async def ask_gemini(prompt):
        try:
            api_url = "https://firebasevertexai.googleapis.com/v1beta/projects/gemmy-ai-bdc03/locations/us-central1/publishers/google/models/gemini-2.0-flash-lite:generateContent"
            headers = {
                'User-Agent': "Ktor client", 
                'Accept': "application/json", 
                'Content-Type': "application/json", 
                'x-goog-api-key': "AIzaSyD6QwvrvnjU7j-R6fkOghfIVKwtvc7SmLk", 
                'x-goog-api-client': "gl-kotlin/2.2.0-ai fire/16.5.0", 
                'x-firebase-appid': "1:652803432695:android:c4341db6033e62814f33f2", 
                'x-firebase-appversion': "79", 
                'x-firebase-appcheck': "eyJlcnJvciI6IlVOS05PV05fRVJST1IifQ=="
            }
            
            payload = {
                "model": "projects/gemmy-ai-bdc03/locations/us-central1/publishers/google/models/gemini-2.0-flash-lite", 
                "contents": [{
                    "role": "user", 
                    "parts": [{"text": prompt}]
                }]
            }

            async with aiohttp.ClientSession() as session:
                async with session.post(api_url, json=payload, headers=headers, timeout=30) as response:
                    if response.status == 200:
                        result = await response.json()
                        if 'candidates' in result and result['candidates']:
                            return result['candidates'][0]['content']['parts'][0]['text'].strip()
            return None
        except:
            return None
    
    # ุฎุฑูุทุฉ ุงูุฃูุงูุฑ (ุชู ุญุฐู ุงูููุณููู ุจูุฌุงุญ)
    command_map = {
        'ุณุคุงู': lambda x: f"ุฃุฌุจ ุนูู ูุฐุง ุงูุณุคุงู ุจุงููุบุฉ ุงูุนุฑุจูุฉ: {x}",
        'ุตูุฑุฉ': lambda x: f"ุตู ุตูุฑุฉ ุชูุตูููุฉ ูู: {x}. ุงูุชุจ ูุตูุงู ุฏูููุงู ููุตูุฑุฉ.",
        'ุตูุฑู': lambda x: f"ุตู ุตูุฑุฉ ุชูุตูููุฉ ูู: {x}. ุงูุชุจ ูุตูุงู ุฏูููุงู ููุตูุฑุฉ.",
        'ููุฏ': lambda x: f"ุงูุชุจ ููุฏ ุจุฑูุฌู ูู: {x}. ูุฏู ุงูููุฏ ูุน ุดุฑุญ ุจุณูุท.",
        'ููุงู': lambda x: f"ุงูุชุจ ููุงูุงู ุนู: {x}. ูุฏู ููุงูุงู ูุชูุงููุงู.",
        'ุชุฑุฌู': lambda x: f"ุชุฑุฌู ุงููุต ุงูุชุงูู ุฅูู ุงูุนุฑุจูุฉ: {x}",
        'ูุฎุต': lambda x: f"ูุฎุต ุงููุต ุงูุชุงูู: {x}",
        'ุญู': lambda x: f"ุญู ุงููุดููุฉ ุงูุชุงููุฉ: {x}. ูุฏู ุญูุงู ููุตูุงู.",
        'ุงููุงุฑ': lambda x: f"ูุฏู 5 ุฃููุงุฑ ุฅุจุฏุงุนูุฉ ุนู: {x}",
        'ุชุนูู': lambda x: f"ุงุดุฑุญ ูู ุนู: {x} ุจุทุฑููุฉ ูุจุณุทุฉ ูุน ุฃูุซูุฉ.",
        'ูุตุฉ': lambda x: f"ุงูุชุจ ูุตุฉ ูุตูุฑุฉ ุนู: {x}",
        'ุดุนุฑ': lambda x: f"ุงูุชุจ ูุตูุฏุฉ ุดุนุฑูุฉ ุนู: {x}",
        'ุชุตููู': lambda x: f"ุตู ุชุตูููุงู ูู: {x}. ูุฏู ูุตูุงู ุชูุตูููุงู.",
        'ุฎุทุท': lambda x: f"ุฎุทุท ูู ูู: {x}. ูุฏู ุฎุทุฉ ููุตูุฉ.",
        'ุงุฎุชุจุฑ': lambda x: f"ุงุฎุชุจุฑ ูุนุฑูุชู ูู: {x}. ุงุทุฑุญ ุณุคุงูุงู.",
        'ุญููุฉ': lambda x: "ูุฏู ูู ุญููุฉ ุนุดูุงุฆูุฉ ูููุฏุฉ."
    }
    
    # ูุญุฑู ูุนุงูุฌุฉ ุงูุฃูุงูุฑ
    for cmd, prompt_func in command_map.items():
        if full_text.startswith(cmd + ' ') or (cmd == 'ุญููุฉ' and full_text == 'ุญููุฉ'):
            user_input = full_text[len(cmd) + 1:] if cmd != 'ุญููุฉ' else ""
            
            await event.edit(f"๐ค **ุฌูุงุฑู ููุนูุงูุฌุฉ ุงููุฃูุฑ '{cmd}'...**")
            
            if cmd == 'ุญููุฉ':
                wisdoms = ["ุงูุตุจุฑ ููุชุงุญ ุงููุฑุฌ.", "ูู ุฌุฏ ูุฌุฏุ ููู ุฒุฑุน ุญุตุฏ.", "ุงูุนูู ูู ุงูุตุบุฑ ูุงูููุด ูู ุงูุญุฌุฑ.", "ุงูููุช ูุงูุณูู ุฅู ูู ุชูุทุนู ูุทุนู."]
                response = f"๐ญ **ุญููุฉ ุงูููู:**\n\n{random.choice(wisdoms)}"
            elif cmd == 'ุงุฎุชุจุฑ':
                topic = user_input.lower()
                questions = {"ุฑูุงุถูุงุช": "ูุง ูู ูุงุชุฌ 15 ร 3ุ", "ุนููู": "ูุง ูู ุฃูุจุฑ ูููุจุ", "ุจุฑูุฌุฉ": "ูุง ูู ูุบุฉ ุชุทุจููุงุช Androidุ"}
                response = f"๐งช **ุณุคุงู ุงุฎุชุจุงุฑ ูู {topic}:**\n\n{questions.get(topic, 'ุงุฎุชุฑ ุฑูุงุถูุงุชุ ุนูููุ ุฃู ุจุฑูุฌุฉ.')}"
            else:
                # ุงุณุชุฎุฏุงู Gemini ููุฃูุงูุฑ ุงูุฐููุฉ
                prompt = prompt_func(user_input)
                response = await ask_gemini(prompt)
                response = f"๐ง **{cmd}:**\n\n{response if response else 'ูุดู ุงูุงุชุตุงู ุจุงููุญุฑู.'}"
            
            await event.edit(response)
            return
    
    await event.edit(f"โ๏ธ **ููู ุฃูููู ุงููุฃูุฑ ููุง ุญูุณูู.** ุงุณุชุฎุฏู `.ุฐูุงุก` ููููุงุฆูุฉ.")

# =========================================================
# ๐จ ุฃูุฑ ุงููุณุงุนุฏุฉ ุงููุญุฏุซ
# =========================================================

@client.on(events.NewMessage(outgoing=True, pattern=r'\.ูุณุงุนุฏุฉ ุฐูุงุก'))
async def ai_help_command(event):
    help_text = """
๐ง **๐ ุณูุฑุณ ูููููู PRO - ููุธุงู ุงููุฐูุงุก ุงููุงุตุทูุงุนู ๐**

**๐ ุทุฑููุฉ ุงูุงุณุชุฎุฏุงู:**
`.ุฐูุงุก ุณุคุงู [ุณุคุงูู]`
`.ุฐูุงุก ุตูุฑุฉ [ูุตู ุงูุตูุฑุฉ]`
`.ุฐูุงุก ููุฏ [ูุบุฉ] [ูุตู ุงูููุฏ]`
`.ุฐูุงุก ุญููุฉ`

**๐จโ๐ป ุงูููุทูุฑ:** ุญุณูู - @iomk0
**๐ข ุงููููุงุฉ:** @iomk3
"""
    await event.edit(help_text)

print("โ ุชู ุชุญููู ูุธุงู ุงูุฐูุงุก ุงูุงุตุทูุงุนู ุงููุญุฏุซ ุจุฏูู ููุณููู!")
